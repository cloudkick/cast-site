

<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

	<head>

		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<title>
			
			Cast Project : developer-information : Coding Guidelines
			
		</title>

		

		<link href="/blog/atom.xml" rel="alternate" title="Cast Project" type="application/atom+xml"/>

		

		

		<link rel="stylesheet" href="/media/css/reset.css" type="text/css" media="screen" charset="utf-8">
		<link rel="stylesheet" href="/media/css/base.css" type="text/css" media="screen" charset="utf-8">
		<link rel="stylesheet" href="/media/css/syntax.css" type="text/css" media="screen" charset="utf-8">

		
		
		
		
		
		

		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>

		
		
		
		

	</head>

	<body>

		<div id="site">	

			<div id="header">
  <a href="/index.html">
    <h1><img src="/media/images/cast_logo.png" id="site-logo" /> Cast Project</h1>
  </a>
</div>








<div id="sitenav">
    <ul>
        <li>
            <a href="/">Home</a>
        </li>

        <li>
            <a href="/start/">Get Started</a>
        </li>

        <li>
            <a href="/docs/">Documentation</a>
        </li>

        <li class="selected" >
            <a href="/developer-information/">Developers</a>
        </li>

        <li>
            <a href="/about/">About</a>
        </li>

        <li>
            <a href="/sitemap/">Sitemap</a>
        </li>
    </ul>
</div>







<ul class="breadcrumbs">
	
		<li>
			<a href="/">Cast Project</a>

			
				
				<span class="separator">&raquo;</span>
				
			
		</li>
	
		<li>
			<a href="/developer-information/">Developer Information</a>

			
				
				<span class="separator">&raquo;</span>
				
			
		</li>
	
		<li>
			<a href="/developer-information/coding-guidelines/">Coding Guidelines</a>

			
		</li>
	
</ul>
    




			


<div id="content-header"><h2>Coding Guidelines</h2></div>



  <p>We know that different people like different styles, but we also know that the
consistency is very important and that is why we enforce strict coding style.</p>
<p>Some of the rules are automatically enforced by
<a href="/developer-information/jslint/">jslint</a> and other are manually checked when
doing code reviews.</p>
<p>Cast styling guide is largely based on the <a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml">Google JavaScript styling
guide</a>,
with a few extra rules to keep common patterns consistent across all of cast.</p>
<h3>Documentation</h3>
<ul>
<li>Use <a href="http://code.google.com/closure/compiler/docs/js-for-compiler.html#tags">JSDoc annotations</a></li>
</ul>
<h3>Asynchronous Code</h3>
<ul>
<li>Don't use Node's *Sync synchronous calls.</li>
<li>Use <a href="https://github.com/caolan/async">async</a> to alleviate excessive nesting
for parallel or serial operations.</li>
<li>Always name callback arguments <code>callback</code></li>
<li>Always name error arguments to a callback <code>err</code></li>
</ul>
<p><strong>Example:</strong></p>
<div class="code"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">onComplete</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span><br />  <span class="kd">var</span> <span class="nx">name</span><span class="p">;</span><br />&nbsp;<br />  <span class="c1">// These actions will be performed in series, until the last action completes</span><br />  <span class="c1">// or callback is fired with an error</span><br />  <span class="nx">async</span><span class="p">.</span><span class="nx">series</span><span class="p">([</span><br />    <span class="c1">// Action #1</span><br />    <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span><br />      <span class="nx">instance</span><span class="p">.</span><span class="nx">getName</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">_name</span><span class="p">)</span> <span class="p">{</span><br />        <span class="nx">name</span> <span class="o">=</span> <span class="nx">_name</span><span class="p">;</span><br />        <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><br />      <span class="p">});</span><br />    <span class="p">},</span><br />&nbsp;<br />    <span class="c1">// Action #2 - async.apply() can be used when the function takes a callback</span><br />    <span class="c1">// with a signature matching that of an async.series() callback. Be</span><br />    <span class="c1">// careful, because the call to async.apply is evaluated *before* the call</span><br />    <span class="c1">// to async.series()</span><br />    <span class="nx">async</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">registerInstance</span><span class="p">,</span> <span class="nx">instance</span><span class="p">)</span><br />  <span class="p">],</span><br />  <span class="c1">// This handler will be called after the series completes or errors out</span><br />  <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span><br />    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span><br />      <span class="nx">log</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;Instance Registered: &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span><br />    <span class="p">}</span><br />    <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><br />  <span class="p">});</span><br /><span class="p">}</span><br /></pre></div><br /></div>

<h3>Naming Conventions</h3>
<p>JSON files and our HTTP API use lower case names with words separated by
underscores in the style commonly used in C or Python. However for all other
names we stick to the camelCase convention more widely used in Javascript. To
keep this straight we have developed the following rules:</p>
<ul>
<li>
<p>Attribute names that will be written to files or network streams (for example
as JSON to a file or HTTP request, HTTP POST parameters, etc) should always use
underscore separated names <code>like_this</code> and should always appear in single
quotes in the code. This means quoting names when defining an object literal,
and using index notation (that is, <code>foo['bar']</code>) when accessing or assigning
attributes. See the example below.</p>
</li>
<li>
<p>For everything else, stick to Google's <a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml?showone=Naming#Naming">naming
rules</a>
for all variable names, <strong>except</strong> when object attribute names are used outside
of cast</p>
</li>
<li>
<p>Use dot notation when accessing object attributes, unless the attribute names
must be in quotes in accordance with the rules above.</p>
</li>
</ul>
<p><strong>Note:</strong> A good way to think about this is that we should be able to use an
automated tool to change a name everywhere it appears outside of quotes in
cast. So if changing the name you are about to use would break existing network
protocols or on-disk formats, put it in quotes. Otherwise don't.</p>
<p><strong>Good:</strong></p>
<div class="code"><div class="highlight"><pre><span class="c1">// This will go in an HTTP POST, so we used single quoted underscored_names</span><br /><span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">querystring</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><br />    <span class="s1">&#39;bundle_name&#39;</span><span class="o">:</span> <span class="nx">bundleName</span><span class="p">,</span><br />    <span class="s1">&#39;bundle_version&#39;</span><span class="o">:</span> <span class="nx">bundleVersion</span><br /><span class="p">});</span><br /><span class="nx">request</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span><br />&nbsp;<br /><span class="c1">// This is just a normal object, so we stick to Google&#39;s naming conventions</span><br /><span class="kd">var</span> <span class="nx">curInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Instance</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span><br /><span class="nx">curInstance</span><span class="p">.</span><span class="nx">getBundleVersion</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span><br />&nbsp;<br /><span class="c1">// This is a constant, so we use Google&#39;s naming conventions here as well</span><br /><span class="kd">var</span> <span class="nx">DEFAULT_SECRET</span> <span class="o">=</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span><br />&nbsp;<br /><span class="c1">// This will be written to a JSON file so attribute names must appear in single</span><br /><span class="c1">// quotes and be underscore_separated</span><br /><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span><br />  <span class="s1">&#39;secret&#39;</span><span class="o">:</span> <span class="nx">DEFAULT_SECRET</span><span class="p">,</span><br />  <span class="s1">&#39;ssl_enabled&#39;</span><span class="o">:</span> <span class="kc">true</span><br /><span class="p">};</span><br />&nbsp;<br /><span class="k">if</span> <span class="p">(</span><span class="nx">config</span><span class="p">[</span><span class="s1">&#39;secret&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">config</span><span class="p">[</span><span class="s1">&#39;ssl_enabled&#39;</span><span class="p">])</span> <span class="p">{</span><br />  <span class="p">...</span><br /><span class="p">}</span><br /></pre></div><br /></div>

<p><strong>Bad:</strong></p>
<div class="code"><div class="highlight"><pre><span class="c1">// The &#39;secret&#39; attribute should appear in single quotes, but does not</span><br /><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span><br />  <span class="nx">secret</span><span class="o">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span><br />  <span class="s1">&#39;ssl_enabled&#39;</span><span class="o">:</span> <span class="kc">true</span><br /><span class="p">}</span><br />&nbsp;<br /><span class="c1">// These should use index notation so the attributes can be in quotes</span><br /><span class="k">if</span> <span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">secret</span> <span class="o">&amp;&amp;</span> <span class="nx">config</span><span class="p">.</span><span class="nx">ssl_enabled</span><span class="p">)</span> <span class="p">{</span><br />  <span class="p">...</span><br /><span class="p">}</span><br /></pre></div><br /></div>

<h3>Miscellaneous</h3>
<ul>
<li>Always put return statement on their own line, unless an actual value is
being returned.</li>
</ul>
<p><strong>Good:</strong></p>
<div class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">onResult</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span><br />  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span><br />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error happened!&#39;</span><span class="p">);</span><br />    <span class="k">return</span><span class="p">;</span><br />  <span class="p">}</span><br /><span class="p">}</span><br /></pre></div><br /></div>

<p><strong>Bad:</strong></p>
<div class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">onResult</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span><br />  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span><br />    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error happened!&#39;</span><span class="p">);</span><br />  <span class="p">}</span><br /><span class="p">}</span><br /></pre></div><br /></div>




			<div id='footer'>Copyright Cast Project</div>


		</div>

	</body>

</html>

